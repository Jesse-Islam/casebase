
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Smooth-in-time fitting of parametric hazard functions">
      
      
        <link rel="canonical" href="https://sahirbhatnagar.github.io/casebase/smoothHazard/">
      
      
        <meta name="author" content="Sahir Bhatnagar, Maxime Turgeon, Olli Saarela, James Hanley">
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.ico">
      
      <meta name="generator" content="mkdocs+mkdocs-material#1.0.2">
    
    
      
        <title>Smooth Hazard - casebase</title>
      
    
    
      <script src="../assets/javascripts/modernizr-facb31f4a3.js"></script>
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-1b8b9fdf68.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-02ce7adcc2.palette.css">
      
      
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="casebase" class=" md-logo  md-header-nav__button">
          
            <img src="../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
            
            Smooth Hazard
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            
              


  


  <a href="https://github.com/sahirbhatnagar/casebase" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      casebase
    </div>
  </a>

            
          </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <i class=" md-logo  md-nav__button">
      
        <img src="../images/logo.png">
      
    </i>
    casebase
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/sahirbhatnagar/casebase" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      casebase
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  <li class="md-nav__item">
    
      <a href=".." title="Home" class="md-nav__link">
        Home
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Smooth Hazard
      </label>
    
    <a href="./" title="Smooth Hazard" class="md-nav__link md-nav__link--active">
      Smooth Hazard
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#methodological-details" title="Methodological details" class="md-nav__link">
    Methodological details
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#first-example" title="First example" class="md-nav__link">
    First example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-information" title="Session information" class="md-nav__link">
    Session information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../popTime/" title="Population Time Plots" class="md-nav__link">
        Population Time Plots
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../competingRisk/" title="Competing Risk" class="md-nav__link">
        Competing Risk
      </a>
    
  </li>

    
      
      
  <li class="md-nav__item">
    
      <a href="../references/" title="References" class="md-nav__link">
        References
      </a>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#methodological-details" title="Methodological details" class="md-nav__link">
    Methodological details
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#first-example" title="First example" class="md-nav__link">
    First example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-information" title="Session information" class="md-nav__link">
    Session information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
               
              
                
                  <h1>Smooth Hazard</h1>
                
                <h2 id="methodological-details">Methodological details<a class="headerlink" href="#methodological-details" title="Permanent link">&para;</a></h2>
<p>Case-base sampling was proposed by Hanley &amp; Miettinen <script type="math/tex; mode=display">-@hanley2009fitting</script> as a way to fit smooth-in-time parametric hazard functions via logistic regression. The main idea, which was first proposed by Mantel <script type="math/tex; mode=display">-@mantel1973synthetic</script> and then later developped by Efron <script type="math/tex; mode=display">-@efron1977efficiency</script>, is to sample person-moments, i.e. discrete time points along an subject's follow-up time, in order to construct a base series against which the case series can be compared.</p>
<p>This approach allows the explicit inclusion of the time variable into the model, which enables the user to fit a wide class of parametric hazard functions. For example, including time linearly recovers the Gompertz hazard, whereas including time <em>logarithmically</em> recovers the Weibull hazard; not including time at all corresponds to the exponential hazard.</p>
<p>The theoretical properties of this approach have been studied in Saarela &amp; Arjas <script type="math/tex; mode=display">-@saarela2015non</script> and Saarela <script type="math/tex; mode=display">-@saarela2015case</script>.</p>
<h2 id="first-example">First example<a class="headerlink" href="#first-example" title="Permanent link">&para;</a></h2>
<p>The first example we discuss uses the well-known <code>veteran</code> dataset, which is part of the <code>survival</code> package. As we can see below, there is almost no censoring, and therefore we can get a good visual representation of the survival function:</p>
<div class="codehilite"><pre><span></span><span class="kn">library</span><span class="p">(</span>survival<span class="p">)</span>
data<span class="p">(</span>veteran<span class="p">)</span>
<span class="kp">table</span><span class="p">(</span>veteran<span class="o">$</span>status<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## 
##   0   1 
##   9 128
</pre></div>


<div class="codehilite"><pre><span></span>evtimes <span class="o">&lt;-</span> veteran<span class="o">$</span>time<span class="p">[</span>veteran<span class="o">$</span>status <span class="o">==</span> <span class="m">1</span><span class="p">]</span>
hist<span class="p">(</span>evtimes<span class="p">,</span> nclass<span class="o">=</span><span class="m">30</span><span class="p">,</span> main<span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> xlab<span class="o">=</span><span class="s">&#39;Survival time (days)&#39;</span><span class="p">,</span> col<span class="o">=</span><span class="s">&#39;gray90&#39;</span><span class="p">,</span> probability<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
tgrid <span class="o">&lt;-</span> <span class="kp">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1000</span><span class="p">,</span> by<span class="o">=</span><span class="m">10</span><span class="p">)</span>
lines<span class="p">(</span>tgrid<span class="p">,</span> dexp<span class="p">(</span>tgrid<span class="p">,</span> rate<span class="o">=</span><span class="m">1.0</span><span class="o">/</span><span class="kp">mean</span><span class="p">(</span>evtimes<span class="p">)),</span> 
      lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
</pre></div>


<p><img src="smoothHazard_files/figure-markdown_github/unnamed-chunk-1-1.png" style="display: block; margin: auto;" /></p>
<p>As we can see, the empirical survival function ressembles an exponential distribution.</p>
<p>We will first try to estimate the hazard function parametrically using some well-known regression routines. But first, we will reformat the data slightly.</p>
<div class="codehilite"><pre><span></span>veteran<span class="o">$</span>prior <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>veteran<span class="o">$</span>prior<span class="p">,</span> levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span>
veteran<span class="o">$</span>celltype <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>veteran<span class="o">$</span>celltype<span class="p">,</span> 
                           levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;large&#39;</span><span class="p">,</span> <span class="s">&#39;squamous&#39;</span><span class="p">,</span> <span class="s">&#39;smallcell&#39;</span><span class="p">,</span> <span class="s">&#39;adeno&#39;</span><span class="p">))</span>
veteran<span class="o">$</span>trt <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>veteran<span class="o">$</span>trt<span class="p">,</span> levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
</pre></div>


<p>Using the <code>eha</code> package, we can fit a Weibull form, with different values of the shape parameter. For <em>s<strong>h</strong>a<strong>p</strong>e</em> = 1, we get an exponential distribution:</p>
<div class="codehilite"><pre><span></span>pacman<span class="o">::</span>p_load<span class="p">(</span>eha<span class="p">)</span>
y <span class="o">&lt;-</span> <span class="kp">with</span><span class="p">(</span>veteran<span class="p">,</span> Surv<span class="p">(</span>time<span class="p">,</span> status<span class="p">))</span>

model1 <span class="o">&lt;-</span> weibreg<span class="p">(</span>y <span class="o">~</span> karno <span class="o">+</span> diagtime <span class="o">+</span> age <span class="o">+</span> prior <span class="o">+</span> celltype <span class="o">+</span> trt<span class="p">,</span> 
                  data <span class="o">=</span> veteran<span class="p">,</span> shape <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
<span class="kp">summary</span><span class="p">(</span>model1<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## Call:
## weibreg(formula = y ~ karno + diagtime + age + prior + celltype + 
##     trt, data = veteran, shape = 1)
## 
## Covariate           Mean       Coef Exp(Coef)  se(Coef)    Wald p
## karno              68.419    -0.031     0.970     0.005     0.000 
## diagtime            8.139     0.000     1.000     0.009     0.974 
## age                57.379    -0.006     0.994     0.009     0.505 
## prior 
##                0    0.653     0         1           (reference)
##               10    0.347     0.049     1.051     0.227     0.827 
## celltype 
##            large    0.269     0         1           (reference)
##         squamous    0.421    -0.377     0.686     0.273     0.166 
##        smallcell    0.206     0.443     1.557     0.261     0.090 
##            adeno    0.104     0.736     2.087     0.294     0.012 
## trt 
##                1    0.477     0         1           (reference)
##                2    0.523     0.220     1.246     0.199     0.269 
## 
## log(scale)                    2.811    16.633     0.713     0.000 
## 
##  Shape is fixed at  1 
## 
## Events                    128 
## Total time at risk         16663 
## Max. log. likelihood      -716.16 
## LR test statistic         70.1 
## Degrees of freedom        8 
## Overall p-value           4.64229e-12
</pre></div>


<p>If we take <em>s<strong>h</strong>a<strong>p</strong>e</em> = 0, the shape parameter is estimated along with the regression coefficients:</p>
<div class="codehilite"><pre><span></span>model2 <span class="o">&lt;-</span> weibreg<span class="p">(</span>y <span class="o">~</span> karno <span class="o">+</span> diagtime <span class="o">+</span> age <span class="o">+</span> prior <span class="o">+</span> celltype <span class="o">+</span> trt<span class="p">,</span> 
                  data <span class="o">=</span> veteran<span class="p">,</span> shape <span class="o">=</span> <span class="m">0</span><span class="p">)</span>
<span class="kp">summary</span><span class="p">(</span>model2<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## Call:
## weibreg(formula = y ~ karno + diagtime + age + prior + celltype + 
##     trt, data = veteran, shape = 0)
## 
## Covariate           Mean       Coef Exp(Coef)  se(Coef)    Wald p
## karno              68.419    -0.032     0.968     0.005     0.000 
## diagtime            8.139     0.001     1.001     0.009     0.955 
## age                57.379    -0.007     0.993     0.009     0.476 
## prior 
##                0    0.653     0         1           (reference)
##               10    0.347     0.047     1.048     0.229     0.836 
## celltype 
##            large    0.269     0         1           (reference)
##         squamous    0.421    -0.428     0.651     0.278     0.123 
##        smallcell    0.206     0.462     1.587     0.262     0.078 
##            adeno    0.104     0.792     2.208     0.300     0.008 
## trt 
##                1    0.477     0         1           (reference)
##                2    0.523     0.246     1.279     0.203     0.224 
## 
## log(scale)                    2.864    17.537     0.671     0.000 
## log(shape)                    0.075     1.077     0.066     0.261 
## 
## Events                    128 
## Total time at risk         16663 
## Max. log. likelihood      -715.55 
## LR test statistic         65.1 
## Degrees of freedom        8 
## Overall p-value           4.65393e-11
</pre></div>


<p>Finally, we can also fit a Cox proportional hazard:</p>
<div class="codehilite"><pre><span></span>model3 <span class="o">&lt;-</span> coxph<span class="p">(</span>y <span class="o">~</span> karno <span class="o">+</span> diagtime <span class="o">+</span> age <span class="o">+</span> prior <span class="o">+</span> celltype <span class="o">+</span> trt<span class="p">,</span> 
                data <span class="o">=</span> veteran<span class="p">)</span>
<span class="kp">summary</span><span class="p">(</span>model3<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## Call:
## coxph(formula = y ~ karno + diagtime + age + prior + celltype + 
##     trt, data = veteran)
## 
##   n= 137, number of events= 128 
## 
##                         coef  exp(coef)   se(coef)      z Pr(&gt;|z|)    
## karno             -3.282e-02  9.677e-01  5.508e-03 -5.958 2.55e-09 ***
## diagtime           8.132e-05  1.000e+00  9.136e-03  0.009  0.99290    
## age               -8.706e-03  9.913e-01  9.300e-03 -0.936  0.34920    
## prior10            7.159e-02  1.074e+00  2.323e-01  0.308  0.75794    
## celltypesquamous  -4.013e-01  6.695e-01  2.827e-01 -1.420  0.15574    
## celltypesmallcell  4.603e-01  1.584e+00  2.662e-01  1.729  0.08383 .  
## celltypeadeno      7.948e-01  2.214e+00  3.029e-01  2.624  0.00869 ** 
## trt2               2.946e-01  1.343e+00  2.075e-01  1.419  0.15577    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##                   exp(coef) exp(-coef) lower .95 upper .95
## karno                0.9677     1.0334    0.9573    0.9782
## diagtime             1.0001     0.9999    0.9823    1.0182
## age                  0.9913     1.0087    0.9734    1.0096
## prior10              1.0742     0.9309    0.6813    1.6937
## celltypesquamous     0.6695     1.4938    0.3847    1.1651
## celltypesmallcell    1.5845     0.6311    0.9403    2.6699
## celltypeadeno        2.2139     0.4517    1.2228    4.0084
## trt2                 1.3426     0.7448    0.8939    2.0166
## 
## Concordance= 0.736  (se = 0.03 )
## Rsquare= 0.364   (max possible= 0.999 )
## Likelihood ratio test= 62.1  on 8 df,   p=1.799e-10
## Wald test            = 62.37  on 8 df,   p=1.596e-10
## Score (logrank) test = 66.74  on 8 df,   p=2.186e-11
</pre></div>


<p>As we can see, all three models are significant, and they give similar information: <code>karno</code> and <code>celltype</code> are significant predictors, both treatment is not.</p>
<p>The method available in this package makes use of <em>case-base sampling</em>. That is, person-moments are randomly sampled across the entire follow-up time, with some moments corresponding to cases and others to controls. By sampling person-moments instead of individuals, we can then use logistic regression to fit smooth-in-time parametric hazard functions. See the previous section for more details.</p>
<p>First, we will look at the follow-up time by using population-time plots:</p>
<div class="codehilite"><pre><span></span>nobs <span class="o">&lt;-</span> <span class="kp">nrow</span><span class="p">(</span>y<span class="p">)</span>
ftime <span class="o">&lt;-</span> veteran<span class="o">$</span>time
ord <span class="o">&lt;-</span> <span class="kp">order</span><span class="p">(</span>ftime<span class="p">,</span> decreasing<span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
plot<span class="p">(</span><span class="m">0</span><span class="p">,</span> type<span class="o">=</span><span class="s">&#39;n&#39;</span><span class="p">,</span> xlim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="kp">max</span><span class="p">(</span>ftime<span class="p">)),</span> ylim<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> nobs<span class="p">),</span> 
     xlab<span class="o">=</span><span class="s">&#39;Follow-up time&#39;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&#39;Population&#39;</span><span class="p">)</span>
segments<span class="p">(</span><span class="kp">rep</span><span class="p">(</span><span class="m">0.0</span><span class="p">,</span> nobs<span class="p">),</span> <span class="m">1</span><span class="o">:</span>nobs<span class="p">,</span> ftime<span class="p">[</span>ord<span class="p">],</span> <span class="m">1</span><span class="o">:</span>nobs<span class="p">,</span> col<span class="o">=</span><span class="s">&#39;gray25&#39;</span><span class="p">)</span>
cases <span class="o">&lt;-</span> veteran<span class="o">$</span>status <span class="o">==</span> <span class="m">1</span>
points<span class="p">((</span>ftime<span class="p">[</span>ord<span class="p">])[</span>cases<span class="p">[</span>ord<span class="p">]],</span> <span class="p">(</span><span class="m">1</span><span class="o">:</span>nobs<span class="p">)[</span>cases<span class="p">[</span>ord<span class="p">]],</span> pch<span class="o">=</span><span class="m">20</span><span class="p">,</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> cex<span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
</pre></div>


<p><img src="smoothHazard_files/figure-markdown_github/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /></p>
<p>Population-time plots are a useful way of visualizing the total follow-up experience, where individuals appear on the y-axis, and follow-up time on the x-axis; each individual's follow-up time is represented by a gray line segment. For convenience, we have ordered the patients according to their time-to-event, and each event is represented by a red dot. The censored observations (of which there is only a few) correspond to the grey lines which do not end with a red dot.</p>
<p>Next, we use case-base sampling to fit a parametric hazard function via logistic regression. First, we will include time as a linear term; as noted above, this corresponds to an Gompertz hazard.</p>
<div class="codehilite"><pre><span></span><span class="kn">library</span><span class="p">(</span>casebase<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## Loading required package: VGAM

## Loading required package: stats4

## Loading required package: splines

## 
## Attaching package: &#39;VGAM&#39;

## The following objects are masked from &#39;package:eha&#39;:
## 
##     dgompertz, dmakeham, pgompertz, pmakeham, qgompertz, qmakeham,
##     rgompertz, rmakeham
</pre></div>


<div class="codehilite"><pre><span></span>model4 <span class="o">&lt;-</span> fitSmoothHazard<span class="p">(</span>status <span class="o">~</span> time <span class="o">+</span> karno <span class="o">+</span> diagtime <span class="o">+</span> age <span class="o">+</span> prior <span class="o">+</span>
             celltype <span class="o">+</span> trt<span class="p">,</span> data <span class="o">=</span> veteran<span class="p">,</span> ratio<span class="o">=</span><span class="m">100</span><span class="p">,</span> type <span class="o">=</span> <span class="s">&quot;uniform&quot;</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## &#39;time&#39; will be used as the time variable
</pre></div>


<div class="codehilite"><pre><span></span><span class="kp">summary</span><span class="p">(</span>model4<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## 
## Call:
## glm(formula = formula, family = binomial, data = sampleData)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.3883  -0.1516  -0.1209  -0.1004   3.4010  
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -2.6972916  0.7327516  -3.681 0.000232 ***
## time               0.0003558  0.0006467   0.550 0.582226    
## karno             -0.0299930  0.0052469  -5.716 1.09e-08 ***
## diagtime           0.0020130  0.0090887   0.221 0.824717    
## age               -0.0098983  0.0093166  -1.062 0.288037    
## prior10            0.0193600  0.2335128   0.083 0.933925    
## celltypesquamous  -0.3717107  0.2850600  -1.304 0.192243    
## celltypesmallcell  0.4900360  0.2632186   1.862 0.062644 .  
## celltypeadeno      0.7575487  0.3014872   2.513 0.011981 *  
## trt2               0.2054208  0.2014424   1.020 0.307847    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1436.2  on 12927  degrees of freedom
## Residual deviance: 1368.6  on 12918  degrees of freedom
## AIC: 1388.6
## 
## Number of Fisher Scoring iterations: 8
</pre></div>


<p>Since the output object from <code>fitSmoothHazard</code> inherits from the <code>glm</code> class, we see a familiar result when using the function <code>summary</code>.</p>
<p>The main purpose of fitting smooth hazard functions is that it is then relatively easy to compute absolute risks. For example, we can use the function <code>absoluteRisk</code> to compute the mean absolute risk at 90 days, which can then be compared to the empirical measure.</p>
<div class="codehilite"><pre><span></span>absoluteRisk<span class="p">(</span>object <span class="o">=</span> model4<span class="p">,</span> time <span class="o">=</span> <span class="m">90</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## [1] 0.5756621
</pre></div>


<div class="codehilite"><pre><span></span><span class="kp">mean</span><span class="p">(</span>ftime <span class="o">&lt;=</span> <span class="m">90</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## [1] 0.5547445
</pre></div>


<p>We can also fit a Weibull hazard by using a logarithmic term for time:</p>
<div class="codehilite"><pre><span></span>model5 <span class="o">&lt;-</span> fitSmoothHazard<span class="p">(</span>status <span class="o">~</span> <span class="kp">log</span><span class="p">(</span>time<span class="p">)</span> <span class="o">+</span> karno <span class="o">+</span> diagtime <span class="o">+</span> age <span class="o">+</span> prior <span class="o">+</span>
             celltype <span class="o">+</span> trt<span class="p">,</span> data <span class="o">=</span> veteran<span class="p">,</span> ratio<span class="o">=</span><span class="m">100</span><span class="p">,</span> type <span class="o">=</span> <span class="s">&quot;uniform&quot;</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## &#39;time&#39; will be used as the time variable
</pre></div>


<div class="codehilite"><pre><span></span><span class="kp">summary</span><span class="p">(</span>model5<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## 
## Call:
## glm(formula = formula, family = binomial, data = sampleData)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4382  -0.1512  -0.1200  -0.0970   3.4049  
## 
## Coefficients:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -3.174679   0.744870  -4.262 2.03e-05 ***
## log(time)          0.079176   0.071940   1.101   0.2711    
## karno             -0.031588   0.005474  -5.770 7.91e-09 ***
## diagtime           0.001787   0.009432   0.190   0.8497    
## age               -0.004762   0.009241  -0.515   0.6063    
## prior10            0.061890   0.232954   0.266   0.7905    
## celltypesquamous  -0.455905   0.278424  -1.637   0.1015    
## celltypesmallcell  0.451326   0.264522   1.706   0.0880 .  
## celltypeadeno      0.758645   0.301447   2.517   0.0118 *  
## trt2               0.245839   0.202616   1.213   0.2250    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1436.2  on 12927  degrees of freedom
## Residual deviance: 1367.2  on 12918  degrees of freedom
## AIC: 1387.2
## 
## Number of Fisher Scoring iterations: 8
</pre></div>


<p>With case-base sampling, it is straightforward to fit a semi-parametric hazard function using splines, which can then be used to estimate the mean absolute risk.</p>
<div class="codehilite"><pre><span></span><span class="c1"># Fit a spline for time</span>
<span class="kn">library</span><span class="p">(</span>splines<span class="p">)</span>
model6 <span class="o">&lt;-</span> fitSmoothHazard<span class="p">(</span>status <span class="o">~</span> bs<span class="p">(</span>time<span class="p">)</span> <span class="o">+</span> karno <span class="o">+</span> diagtime <span class="o">+</span> age <span class="o">+</span> prior <span class="o">+</span>
             celltype <span class="o">+</span> trt<span class="p">,</span> data <span class="o">=</span> veteran<span class="p">,</span> ratio<span class="o">=</span><span class="m">100</span><span class="p">,</span> type <span class="o">=</span> <span class="s">&quot;uniform&quot;</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## &#39;time&#39; will be used as the time variable
</pre></div>


<div class="codehilite"><pre><span></span><span class="kp">summary</span><span class="p">(</span>model6<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## 
## Call:
## glm(formula = formula, family = binomial, data = sampleData)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4419  -0.1524  -0.1188  -0.0962   3.5366  
## 
## Coefficients:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -2.802692   0.733669  -3.820 0.000133 ***
## bs(time)1          1.462042   1.020984   1.432 0.152145    
## bs(time)2         -2.563804   1.744367  -1.470 0.141626    
## bs(time)3          1.761402   0.986614   1.785 0.074213 .  
## karno             -0.033064   0.005477  -6.037 1.57e-09 ***
## diagtime           0.002782   0.009481   0.293 0.769201    
## age               -0.006766   0.009401  -0.720 0.471725    
## prior10           -0.026913   0.233568  -0.115 0.908265    
## celltypesquamous  -0.398003   0.282814  -1.407 0.159339    
## celltypesmallcell  0.436973   0.265627   1.645 0.099957 .  
## celltypeadeno      0.737056   0.304795   2.418 0.015597 *  
## trt2               0.221856   0.206569   1.074 0.282820    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1436.2  on 12927  degrees of freedom
## Residual deviance: 1362.6  on 12916  degrees of freedom
## AIC: 1386.6
## 
## Number of Fisher Scoring iterations: 8
</pre></div>


<div class="codehilite"><pre><span></span>absoluteRisk<span class="p">(</span>object <span class="o">=</span> model6<span class="p">,</span> time <span class="o">=</span> <span class="m">90</span><span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## [1] 0.5769713
</pre></div>


<p>As we can see from the summary, there is little evidence that splines actually improve the fit. Moreover, we can see that estimated individual absolute risks are essentially the same when using either a linear term or splines:</p>
<div class="codehilite"><pre><span></span>linearRisk <span class="o">&lt;-</span> absoluteRisk<span class="p">(</span>object <span class="o">=</span> model4<span class="p">,</span> time <span class="o">=</span> <span class="m">90</span><span class="p">,</span> newdata <span class="o">=</span> veteran<span class="p">)</span>
splineRisk <span class="o">&lt;-</span> absoluteRisk<span class="p">(</span>object <span class="o">=</span> model6<span class="p">,</span> time <span class="o">=</span> <span class="m">90</span><span class="p">,</span> newdata <span class="o">=</span> veteran<span class="p">)</span>
</pre></div>


<div class="codehilite"><pre><span></span>## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases

## Warning in bs(time, degree = 3L, knots = numeric(0), Boundary.knots =
## c(0.00457866885699332, : some &#39;x&#39; values beyond boundary knots may cause
## ill-conditioned bases
</pre></div>


<div class="codehilite"><pre><span></span>plot<span class="p">(</span>linearRisk<span class="p">,</span> splineRisk<span class="p">,</span>
     xlab<span class="o">=</span><span class="s">&quot;Linear&quot;</span><span class="p">,</span> ylab <span class="o">=</span> <span class="s">&quot;Splines&quot;</span><span class="p">,</span> pch<span class="o">=</span><span class="m">19</span><span class="p">)</span>
abline<span class="p">(</span>a<span class="o">=</span><span class="m">0</span><span class="p">,</span> b<span class="o">=</span><span class="m">1</span><span class="p">,</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> col<span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
</pre></div>


<p><img src="smoothHazard_files/figure-markdown_github/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /></p>
<p>These last three models give similar information as the first three, i.e. the main predictors for the hazard are <code>karno</code> and <code>celltype</code>, with treatment being non-significant. Moreover, by explicitely including the time variable in the formula, we see that it is not significant; this is evidence that the true hazard is exponential.</p>
<h2 id="session-information">Session information<a class="headerlink" href="#session-information" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span>## R version 3.3.2 (2016-10-31)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 16.04.1 LTS
## 
## attached base packages:
## [1] splines   stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
## [1] casebase_0.0.9000 VGAM_1.0-3        eha_2.4-4         survival_2.40-1  
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.9       knitr_1.15.1      magrittr_1.5     
##  [4] munsell_0.4.3     colorspace_1.3-2  lattice_0.20-34  
##  [7] plyr_1.8.4        stringr_1.1.0     tools_3.3.2      
## [10] grid_3.3.2        data.table_1.10.0 gtable_0.2.0     
## [13] pacman_0.4.1      htmltools_0.3.5   assertthat_0.1   
## [16] lazyeval_0.2.0    yaml_2.1.14       rprojroot_1.2    
## [19] digest_0.6.12     tibble_1.2        Matrix_1.2-7.1   
## [22] ggplot2_2.2.1     evaluate_0.10     rmarkdown_1.3    
## [25] stringi_1.1.2     scales_0.4.1      backports_1.0.5
</pre></div>


<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href=".." title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="../popTime/" title="Population Time Plots" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Population Time Plots
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2017 <a href="http://turgeonmaxime.github.io/">Maxime Turgeon</a>, <a href="http://sahirbhatnagar.com/">Sahir Bhatnagar</a>, <a href="http://individual.utoronto.ca/osaarela/">Olli Saarela</a>, <a href="http://www.medicine.mcgill.ca/epidemiology/hanley/">James Hanley</a>
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/sahirbhatnagar/casebase" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/syfi_24" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-16f434a21a.js"></script>
      <script>var config={url:{base:".."}},app=new Application(config);app.initialize()</script>
      
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
    
      
    
  </body>
</html>